\usepackage{graphicx}
\usepackage{verbatim}
\usepackage{latexsym}
\usepackage[version=4]{mhchem}
\usepackage{mathchars}
\usepackage{setspace}
\usepackage[toc,page]{appendix}
\usepackage{float}
% \usepackage{subfigure}
\usepackage{subcaption}
\usepackage{url}
\usepackage{hyperref}
\hypersetup{
     colorlinks=true,
     linkcolor=black,
     filecolor=black,
     citecolor=black,
     urlcolor=blue,
}
% \usepackage[colorlinks=true]{hyperref}
\usepackage{cprotect}

\usepackage[]{inputenc}
\newcommand{\textgreek}[1]{\begingroup\fontencoding{LGR}\selectfont#1\endgroup}
\usepackage[english]{babel}
\usepackage[autostyle, english=british]{csquotes}
\MakeOuterQuote{"}
%fonts; currently look weird with math.
%\usepackage[sfdefault]{roboto}
\usepackage[LGR,T1]{fontenc}
%Per chapter appendix setup
%\usepackage{appendix}
%\usepackage{chngcntr}
%\usepackage{etoolbox}

%directory tree
\usepackage{forest}
%folder colors
\definecolor{folderbg}{RGB}{124,166,198}
\definecolor{folderborder}{RGB}{110,144,169}
%folder definitions
\def\Size{4pt}
\tikzset{
      folder/.pic={
        \filldraw[draw=folderborder,top color=folderbg!50,bottom color=folderbg]
          (-1.05*\Size,0.2\Size+5pt) rectangle ++(.75*\Size,-0.2\Size-5pt);  
        \filldraw[draw=folderborder,top color=folderbg!50,bottom color=folderbg]
          (-1.15*\Size,-\Size) rectangle (1.15*\Size,\Size);
      }
    }

\usepackage{pythonhighlight}
\usepackage{xcolor,colortbl}

% Start of subappendices environment
\AtBeginEnvironment{subappendices}{%
    \cleardoublepage
    \appendixtocoff
    \phantomsection
    \addcontentsline{toc}{section}{Appendices}
    \appendixpage
    \makeatother
    \appendixheaderon
    %\sectionmark{Appendices}
    %\addappheadtotoc
    
    \setcounter{figure}{0}
    \setcounter{table}{0}
    \renewcommand\thefigure{\thechapter.A\arabic{figure}}
    \renewcommand\thetable{\thechapter.A\arabic{table}}
}

% End of subappendices environment
\AtEndEnvironment{subappendices}{%
    \setcounter{figure}{0}
    \setcounter{table}{0}
    \renewcommand\thefigure{\thechapter.\arabic{figure}}
    \renewcommand\thetable{\thechapter.\arabic{table}}
}
    
%reference setup
\usepackage[sectionbib, super, sort&compress, comma]{natbib}
\usepackage{chapterbib}
\setlength{\bibsep}{0.0pt}

\makeatletter 
\renewcommand\@biblabel[1]{#1.$\>\>$} 

\usepackage[nottoc]{tocbibind} %should fix references indexing
\settocbibname{References}

%\usepackage{apalike}

%might fix citation overhang on p38
%\usepackage{microtype}
% SI units, scientific notation
\usepackage{siunitx}
\DeclareSIUnit\angstrom{\text{\AA}}
\DeclareSIUnit\bar{bar}
\DeclareSIUnit\wtpercent{wt.\%}
\DeclareSIUnit\volpercent{vol.\%}
\sisetup{separate-uncertainty=true}
     
\usepackage{tabularx}
\usepackage{booktabs}
\usepackage{multirow}
\usepackage[normalem]{ulem}

% remove [demo] to actually display pdf. 
% Currently just displays empty pages
\usepackage{pdfpages}

\usepackage[htt]{hyphenat}

\usepackage[acronym, nonumberlist,]{glossaries}

% for H1. H2. enumeration
\usepackage{enumitem}

\usepackage{amsmath}
\usepackage{changepage}

\usepackage{acro}

%upright greek characters
%\usepackage[upgreek, LGRgreek]{mathastext}
%capital greek letters
%\usepackage{unicode-math} %won't compile with pdfLatex



% for C# code formatting
\usepackage{color}
\usepackage{listings}
\usepackage{spverbatim}
\lstloadlanguages{% Check Dokumentation for further languages ...
C,
C++,
csh,
Java
}

\definecolor{red}{rgb}{0.6,0,0} % for strings
\definecolor{blue}{rgb}{0,0,0.6}
\definecolor{green}{rgb}{0,0.8,0}
\definecolor{cyan}{rgb}{0.0,0.6,0.6}
\lstset{
basicstyle=\small\ttfamily, 
stringstyle=\color{black}\ttfamily, 
showstringspaces=false,
showspaces=false,
xleftmargin=17pt,
breaklines=true,
}
\usepackage{caption}

% number subsubsections
\setcounter{secnumdepth}{3}

% for table of contents to show Chapter
\usepackage{tocloft}
\renewcommand{\cftchappresnum}{Chapter }
\AtBeginDocument{\addtolength\cftchapnumwidth{\widthof{Chapter}}}

% for table of contents to show Appendix
%\begin{comment}
\renewcommand{\cftchappresnum}{\chaptername\space}
\setlength{\cftchapnumwidth}{\widthof{Appendix}}
\makeatletter
\g@addto@macro\appendix{%
  \addtocontents{toc}{%
    \protect\renewcommand{\protect\cftchappresnum}{\appendixname\space}
  }%
}
%\end{comment}

% mini table of content
\usepackage{minitoc}
\setlength{\mtcindent}{24pt}
\renewcommand{\mtcoffset}{0pt}
\mtcsetoffset{minitoc}{0pt} \setlength{\mtcskipamount}{\bigskipamount}
\mtcsetdepth{minitoc}{2} \mtcsetfont{minitoc}{*}{\small\rmfamily\upshape\mdseries} \mtcsetfont{minitoc}{section}{\small\rmfamily\upshape\bfseries}
\setcounter{mtc}{9}

\usepackage{fancyhdr}
% \fancypagestyle{plain}{%  the preset of fancyhdr 
%     \fancyhf{} % clear all header and footer fields
%     \fancyhead[C]{\textbf{\rightmark}}
%     % \fancyhead[R]{\textbf{\rightmark}}
%     % \pagenumbering{arabic}
%     % \fancyfoot[R]{\thepage}
%     \renewcommand{\headrulewidth}{0pt}
%     \renewcommand{\footrulewidth}{0pt}}
    
\fancypagestyle{front}{% style for TOC, LOF, LOT
  \fancyhf{}
  \renewcommand{\headrulewidth}{0pt}
  \cfoot{\thepage}
}
\fancypagestyle{main}{% style for the mainmatter
  \fancyhf{}
  \fancyhead[C]{\slshape \rightmark}
  \fancyfoot[C]{\thepage}
  \renewcommand\headrulewidth{.4pt}
}
\makeatletter
  \newcommand\frontpagestyle{\cleardoublepage\pagestyle{front}\let\ps@plain\ps@front}
  \newcommand\mainpagestyle{\cleardoublepage\pagestyle{main}\let\ps@plain\ps@main}
\makeatother

\input{blocked.sty}
% \input{uhead.sty}
\input{boxit.sty}
\input{thesis.sty}

\newcommand{\ipc}{{\sf ipc}}
\newcommand{\Prob}{\bbbp}
\newcommand{\Real}{\bbbr}
\newcommand{\real}{\Real}
\newcommand{\Int}{\bbbz}
\newcommand{\Nat}{\bbbn}

\newcommand{\NN}{{\sf I\kern-0.14emN}}   % Natural numbers
\newcommand{\ZZ}{{\sf Z\kern-0.45emZ}}   % Integers
\newcommand{\QQQ}{{\sf C\kern-0.48emQ}}   % Rational numbers
\newcommand{\RR}{{\sf I\kern-0.14emR}}   % Real numbers
\newcommand{\KK}{{\cal K}}
\newcommand{\OO}{{\cal O}}
\newcommand{\AAA}{{\bf A}}
\newcommand{\HH}{{\bf H}}
\newcommand{\II}{{\bf I}}
\newcommand{\LL}{{\bf L}}
\newcommand{\PP}{{\bf P}}
\newcommand{\PPprime}{{\bf P'}}
\newcommand{\QQ}{{\bf Q}}
\newcommand{\UU}{{\bf U}}
\newcommand{\UUprime}{{\bf U'}}
\newcommand{\zzero}{{\bf 0}}
\newcommand{\ppi}{\mbox{\boldmath $\pi$}}
\newcommand{\aalph}{\mbox{\boldmath $\alpha$}}
\newcommand{\bb}{{\bf b}}
\newcommand{\ee}{{\bf e}}
\newcommand{\mmu}{\mbox{\boldmath $\mu$}}
\newcommand{\vv}{{\bf v}}
\newcommand{\xx}{{\bf x}}
\newcommand{\yy}{{\bf y}}
\newcommand{\zz}{{\bf z}}
\newcommand{\oomeg}{\mbox{\boldmath $\omega$}}
\newcommand{\res}{{\bf res}}
\newcommand{\cchi}{{\mbox{\raisebox{.4ex}{$\chi$}}}}
%\newcommand{\cchi}{{\cal X}}
%\newcommand{\cchi}{\mbox{\Large $\chi$}}

% Logical operators and symbols
\newcommand{\imply}{\Rightarrow}
\newcommand{\bimply}{\Leftrightarrow}
\newcommand{\union}{\cup}
\newcommand{\intersect}{\cap}
\newcommand{\boolor}{\vee}
\newcommand{\booland}{\wedge}
\newcommand{\boolimply}{\imply}
\newcommand{\boolbimply}{\bimply}
\newcommand{\boolnot}{\neg}
\newcommand{\boolsat}{\!\models}
\newcommand{\boolnsat}{\!\not\models}


\newcommand{\op}[1]{\mathrm{#1}}
\newcommand{\s}[1]{\ensuremath{\mathcal #1}}

% Properly styled differentiation and integration operators
\newcommand{\diff}[1]{\mathrm{\frac{d}{d\mathit{#1}}}}
\newcommand{\diffII}[1]{\mathrm{\frac{d^2}{d\mathit{#1}^2}}}
\newcommand{\intg}[4]{\int_{#3}^{#4} #1 \, \mathrm{d}#2}
\newcommand{\intgd}[4]{\int\!\!\!\!\int_{#4} #1 \, \mathrm{d}#2 \, \mathrm{d}#3}

% Large () brackets on different lines of an eqnarray environment
\newcommand{\Leftbrace}[1]{\left(\raisebox{0mm}[#1][#1]{}\right.}
\newcommand{\Rightbrace}[1]{\left.\raisebox{0mm}[#1][#1]{}\right)}

%should send footnotes to very bottom of page
\usepackage[bottom]{footmisc}
% Funky symobols for footnotes
\newcommand{\symbolfootnote}{\renewcommand{\thefootnote}{\fnsymbol{footnote}}}
% now add \symbolfootnote to the beginning of the document...
% update footnote counter for each chapter
\counterwithin*{footnote}{chapter}

\newcommand{\normallinespacing}{\renewcommand{\baselinestretch}{1.5} \normalsize}
\newcommand{\mediumlinespacing}{\renewcommand{\baselinestretch}{1.2} \normalsize}
\newcommand{\narrowlinespacing}{\renewcommand{\baselinestretch}{1.0} \normalsize}
\newcommand{\bump}{\noalign{\vspace*{\doublerulesep}}}
\newcommand{\cell}{\multicolumn{1}{}{}}
\newcommand{\spann}{\mbox{span}}
\newcommand{\diagg}{\mbox{diag}}
\newcommand{\modd}{\mbox{mod}}
\newcommand{\minn}{\mbox{min}}
\newcommand{\andd}{\mbox{and}}
\newcommand{\forr}{\mbox{for}}
\newcommand{\EE}{\mbox{E}}

\newcommand{\deff}{\stackrel{\mathrm{def}}{=}}
\newcommand{\syncc}{~\stackrel{\textstyle \rhd\kern-0.57em\lhd}{\scriptstyle L}~}

\def\coop{\mbox{\large $\rhd\!\!\!\lhd$}}
\newcommand{\sync}[1]{\raisebox{-1.0ex}{$\;\stackrel{\coop}{\scriptscriptstyle
#1}\,$}}

\newtheorem{definition}{Definition}[chapter]
\newtheorem{theorem}{Theorem}[chapter]

\newcommand{\Figref}[1]{Figure~\ref{#1}}
\newcommand{\fig}[3]{
 \begin{figure}[!ht]
 \begin{center}
 \scalebox{#3}{\includegraphics{figs/#1.ps}}
 \vspace{-0.1in}
 \caption[ ]{\label{#1} #2}
 \end{center}
 \end{figure}
}

\newcommand{\figtwo}[8]{
 \begin{figure}
 \parbox[b]{#4 \textwidth}{
 \begin{center}
 \scalebox{#3}{\includegraphics{figs/#1.ps}}
 \vspace{-0.1in}
 \caption{\label{#1}#2}
 \end{center}
 }
 \hfill
 \parbox[b]{#8 \textwidth}{
 \begin{center}
 \scalebox{#7}{\includegraphics{figs/#5.ps}}
 \vspace{-0.1in}
 \caption{\label{#5}#6}
 \end{center}
 }
 \end{figure}
}

%for changing offsets when pdfs inserted
\newlength{\originalVOffset}
\newlength{\originalHOffset}

\usepackage{pdflscape}
%\usepackage{rotating}
\usepackage{sidecap}
\sidecaptionvpos{figure}{t}